{
  "resolvedId": "/home/jackshelton/dev/open-source/astro-qwik/node_modules/.pnpm/astro@3.1.0/node_modules/astro/dist/core/middleware/callMiddleware.js",
  "transforms": [
    {
      "name": "vite:load-fallback",
      "result": "import { bold } from \"kleur/colors\";\nimport { AstroError, AstroErrorData } from \"../errors/index.js\";\nasync function callMiddleware(logger, onRequest, apiContext, responseFunction) {\n  let nextCalled = false;\n  let responseFunctionPromise = void 0;\n  const next = async () => {\n    nextCalled = true;\n    responseFunctionPromise = responseFunction();\n    return responseFunctionPromise;\n  };\n  let middlewarePromise = onRequest(apiContext, next);\n  return await Promise.resolve(middlewarePromise).then(async (value) => {\n    if (isEndpointOutput(value)) {\n      logger.warn(\n        \"middleware\",\n        `Using simple endpoints can cause unexpected issues in the chain of middleware functions.\nIt's strongly suggested to use full ${bold(\"Response\")} objects.`\n      );\n    }\n    if (nextCalled) {\n      if (typeof value !== \"undefined\") {\n        if (value instanceof Response === false) {\n          throw new AstroError(AstroErrorData.MiddlewareNotAResponse);\n        }\n        return value;\n      } else {\n        if (responseFunctionPromise) {\n          return responseFunctionPromise;\n        } else {\n          throw new AstroError(AstroErrorData.MiddlewareNotAResponse);\n        }\n      }\n    } else if (typeof value === \"undefined\") {\n      throw new AstroError(AstroErrorData.MiddlewareNoDataOrNextCalled);\n    } else if (value instanceof Response === false) {\n      throw new AstroError(AstroErrorData.MiddlewareNotAResponse);\n    } else {\n      return value;\n    }\n  });\n}\nfunction isEndpointOutput(endpointResult) {\n  return !(endpointResult instanceof Response) && typeof endpointResult === \"object\" && typeof endpointResult.body === \"string\";\n}\nexport {\n  callMiddleware\n};\n",
      "start": 1696585309131,
      "end": 1696585309219,
      "sourcemaps": null
    },
    {
      "name": "astro:build",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "pre"
    },
    {
      "name": "astro:vite-plugin-env",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "pre"
    },
    {
      "name": "astro:jsx",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "pre"
    },
    {
      "name": "astro:content-asset-propagation",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "pre"
    },
    {
      "name": "vite-plugin-qwik",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "pre"
    },
    {
      "name": "vite-plugin-qwik",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "pre"
    },
    {
      "name": "vite:css",
      "start": 1696585309219,
      "end": 1696585309219,
      "order": "normal"
    },
    {
      "name": "vite:esbuild",
      "start": 1696585309219,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:json",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:worker",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "astro:html",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "astro:postprocess",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "astro:head-metadata",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "astro:content-imports",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:define",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:css-post",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:worker-import-meta-url",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:asset-import-meta-url",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "commonjs",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:dynamic-import-vars",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:import-glob",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "astro:scripts:page-ssr",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "post"
    },
    {
      "name": "astro:scanner",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "post"
    },
    {
      "name": "vite:build-import-analysis",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    },
    {
      "name": "vite:reporter",
      "start": 1696585309220,
      "end": 1696585309220,
      "order": "normal"
    }
  ]
}
